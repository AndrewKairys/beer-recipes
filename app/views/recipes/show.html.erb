<div class="recipe-form">
  <div class="show-recipe">
    <h2 class="recipe-header recipeName"><%= @recipe.name %></h2>

    <h3>Created By: <span class="userName"><%= @recipe.user.name %></span></h3>

    <h3>Style: <span class="styleName"><%= @recipe.style.name %></span></h3>

    <h3>Fermentables</h3>
    <% @recipe.recipe_fermentables.sort_by { |f| f.fermentable.name.downcase }.each do |recipe_fermentable| %>
        <ul>
          <li><%= recipe_fermentable.fermentable.name %> | <%= recipe_fermentable.amount %> lbs</li>
        </ul>
    <% end %>

    <h3>Hops</h3>
      <ul class="hops">
        <% @recipe.recipe_hops.order(:addition_time, :amount).reverse.each do |recipe_hop| %>
          <li>
            <span><%= recipe_hop.hop.name %></span> |
            <span><%= recipe_hop.amount %></span> oz |
            <span><%= recipe_hop.addition_time %></span> min
          </li>
        <% end %>
      </ul>

    <h3>Yeast</h3>
      <ul class="yeasts">
        <% @recipe.recipe_yeasts.sort_by { |ry| [ry.yeast.brand.downcase, ry.yeast.variety.downcase] }.each do |recipe_yeast| %>
          <li><%= recipe_yeast.yeast.brand %></li>
          <ul>
            <li><%= recipe_yeast.yeast.variety %></li>
          </ul>
        <% end %>
      </ul>

    <!-- DELETE INLINE SYTLING -->
    <a href="#" class="js-next" data-id="<%=@recipe.id%>" data-user-id="<%=@recipe.user.id%>" style="color: black;">Next Recipe</a>

    <div class="edit-delete-links">
      <%= edit_button_if_current_user %>
      <%= delete_button_if_current_user %>
    </div>
  </div>
</div>

<script type="text/javascript" charset="utf-8">
  $(function () {
    $(".js-next").on("click", function() {
      const userId = parseInt($(".js-next").attr("data-user-id"))
      const nextId = parseInt($(".js-next").attr("data-id")) + 1;

      $.get("/users/" + userId + "/recipes/" + nextId + ".json", function(data) {
        $(".recipeName").text(data.name);
        $(".userName").text(data.user.name);
        $(".styleName").text(data.style.name);

        const recipeHops = data.recipe_hops
        const hops = data.hops
        $(".hops").html("")
        for (var i = 0, l = recipeHops.length; i < l; ++i) {
          $(".hops").append("<li>" + hops[i].name + " | " + recipeHops[i].amount + " oz | " + recipeHops[i].addition_time + " min</li>");
        }

        const yeasts = data.yeasts
        $(".yeasts").html("")
        for (var i = 0, l = yeasts.length; i < l; ++i) {
          $(".yeasts").append("<li>" + yeasts[i].brand + "</li>" +
                            "<ul>" +
                              "<li>" + yeasts[i].variety + "</li>" +
                            "</ul>");
        }

        $(".js-next").attr("data-id", data["id"]);
      });
    });
  });
</script>
